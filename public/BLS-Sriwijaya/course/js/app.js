/* Created and coded by Abhilash Narayan */
/* Quiz source: w3schools.com */

var quiz = {
  "JS": [
    {
      "id": 1,
      "question": "Bantuan Hidup Dasar (BHD) merupakan",
      "options": [
        {
          "a": "Pertolongan pertama yang dilakukan pada seseorang yang mengalami henti jantung",
          "b": "Tindakan yang dilakukan pada seseorang yang mengalami patah tulang",
          "c": "Tindakan yang dilakukan pada seseorang yang mengalami nyeri",
          "d": "Pertolongan yang hanya dilakukan oleh tenaga kesehatan yang berkompetensi"
        }
      ],
      "answer": "Pertolongan pertama yang dilakukan pada seseorang yang mengalami henti jantung",
      "score": 0,
      "status": ""
    },
    {
      "id": 2,
      "question": "Seseorang diberikan Bantuan Hidup Dasar (BHD) apabila",
      "options": [
        {
          "a": "Henti jantung dan atau henti nafas",
          "b": "Luka",
          "c": "Patah tulang",
          "d": "Terlihat pingsan di tengah jalan"
        }
      ],
      "answer": "Henti jantung dan atau henti nafas",
      "score": 0,
      "status": ""
    },
    {
      "id": 3,
      "question": "Tindakan Bantuan Hidup Dasar (BHD) terdiri dari",
      "options": [
        {
          "a": "Pembebasan jalan napas dan memberi bantuan napas",
          "b": "Pembebasan jalan napas dan sirkulasi",
          "c": "Pembebasan jalan napas, memberikan bantuan napas, dan kompresi jantung",
          "d": "Kompresi jantung saja"
        }
      ],
      "answer": "Pembebasan jalan napas, memberikan bantuan napas, dan kompresi jantung",
      "score": 0,
      "status": ""
    },
    {
      "id": 4,
      "question": "Dalam Bantuan Hidup Dasar (BHD) dikenal istilah CAB yang merupakan singkatan dari",
      "options": [
        {
          "a": "Calm, Airway, and Breathing",
          "b": "Circulation, Airway, and Breathing",
          "c": "Circulation, Airway, and Blood",
          "d": "Circulation, Air-Oxygen, and Breathing "
        }
      ],
      "answer": "Circulation, Airway, and Breathing",
      "score": 0,
      "status": ""
    },
    {
      "id": 5,
      "question": "Saat menemukan korban yang tidak sadar di tengah jalan, hal yang pertama kali kita lakukan adalah",
      "options": [
        {
          "a": "Verifikasi keamanan tempat kejadian",
          "b": "Cek respon dengan menepuk pundak korban sambil memanggil , 'Pak! Pak!' atau 'Ibu! Ibu!'",
          "c": "Membebaskan jalan napas",
          "d": "Kompresi jantung",
        }
      ],
      "answer": "Verifikasi keamanan tempat kejadian",
      "score": 0,
      "status": ""
    },
    {
      "id": 6,
      "question": "Apabila korban tidak memberikan respon, yang perlu dilakukan selanjutnya adalah",
      "options": [
        {
          "a": "Memberikan jalan napas",
          "b": "Cek nadi korban",
          "c": "Meminta bantuan atau hubungi nomor darurat (ambulans atau rumah  sakit terdekat)",
          "d": "Kompresi jantung"
        }
      ],
      "answer": "Meminta bantuan atau hubungi nomor darurat (ambulans atau rumah  sakit terdekat)",
      "score": 0,
      "status": ""
    },
    {
      "id": 7,
      "question": "Lokasi yang tepat untuk melakukan kompresi jantung pada anak umur 8 tahun adalah",
      "options": [
        {
          "a": "Di tengah perut",
          "b": "Setengah bawah sternum",
          "c": "Diantara perut dan dada",
          "d": "Di sternum bagian atas"
        }
      ],
      "answer": "Setengah bawah sternum",
      "score": 0,
      "status": ""
    },
    {
      "id": 8,
      "question": "Tindakan kompresi jantung dilakukan pada",
      "options": [
        {
          "a": "Alas yang keras dan datar",
          "b": "Alas yang keras dan tidak datar",
          "c": "Alas yang lunak dan datar",
          "d": "Alas apapun asalkan dilakukan oleh tenaga kesehatan berkompeten",
        }
      ],
      "answer": "Alas yang keras dan datar",
      "score": 0,
      "status": ""
    },
    {
      "id": 9,
      "question": "Kompresi jantung dan pemberian napas pada dewasa dilakukan dengan perbandingan",
      "options": [
        {
          "a": "30 : 2 (30 kali kompresi jantung : 2 kali napas buatan)",
          "b": "30 : 1 (30 kali kompresi jantung : 1 kali napas buatan)",
          "c": "15 : 2 (15 kali kompresi jantung : 2 kali napas buatan)",
          "d": "15 : 4 (15 kali kompresi jantung : 4 kali napas buatan)"
        }
      ],
      "answer": "30 : 2 (30 kali kompresi jantung : 2 kali napas buatan)",
      "score": 0,
      "status": ""
    },
    {
      "id": 10,
      "question": "Kompresi jantung dilakukan dengan frekuensi / kecepatan",
      "options": [
        {
          "a": "50x per menit",
          "b": "80x per menit",
          "c": "100-120x per menit",
          "d": ">120x per menit",
        }
      ],
      "answer": "100-120x per menit",
      "score": 0,
      "status": ""
    },
    {
      "id": 11,
      "question": "Dalam pelaksanaan kompresi jantung pada anak umur 6 tahun, minimal kedalaman kompresi jantung adalah",
      "options": [
        {
          "a": "2,5 cm",
          "b": "3 cm",
          "c": "5 cm",
          "d": "7 cm"
        }
      ],
      "answer": "5 cm",
      "score": 0,
      "status": ""
    },
    {
      "id": 12,
      "question": "Pembebasan jalan napas dilakukan dengan beberapa cara, salah satunya",
      "options": [
        {
          "a": "Menekan dahi ke belakang",
          "b": "Kepala tengadah dan dagu diangkat",
          "c": "Mengangkat dagu",
          "d": "Mengangkat batang hidung"
        }
      ],
      "answer": "Kepala tengadah dan dagu diangkat",
      "score": 0,
      "status": ""
    },
    {
      "id": 13,
      "question": "Menilai pernapasan dapat dilakukan dengan cara",
      "options": [
        {
          "a": "Melihat gerakan dada dan merasakan hembusan napas",
          "b": "Melihat gerakan dada saja",
          "c": "Mendengar suara napas",
          "d": "Menghitung respiratory rate"
        }
      ],
      "answer": "Melihat gerakan dada dan merasakan hembusan napas",
      "score": 0,
      "status": ""
    },
    {
      "id": 14,
      "question": "Pemeriksaan nadi dilakukan setiap ... siklus kompresi jantung dan pemberian napas buatan",
      "options": [
        {
          "a": "2 siklus",
          "b": "3 silkus",
          "c": "5 siklus",
          "d": "Sampai penolong datang"
        }
      ],
      "answer": "5 siklus",
      "score": 0,
      "status": ""
    },
    {
      "id": 15,
      "question": "Setelah melakukan tindakan BHD dan korban telah sadar, selanjutnya yang kita lakukan pada korban adalah ",
      "options": [
        {
          "a": "Membantu korban duduk",
          "b": "Mengecek GCS korban",
          "c": "Membantu korban berdiri",
          "d": "Membantu korban melakukan recovery position"
        }
      ],
      "answer": "Membantu korban melakukan recovery position",
      "score": 0,
      "status": ""
    },
    {
      "id": 16,
      "question": "Tindakan kompresi jantung dapat dihentikan apabila",
      "options": [
        {
          "a": "Penolong dalam keadaan letih atau bantuan medis telah datang atau korban kembali pulih",
          "b": "Penolong tidak mau lagi atau merasa tidak layak melakukan kompresi jantung",
          "c": "Penolong merasa tidak berhak atau merasa salah saat kompresi jantung",
          "d": "Penolong takut digugat secara hukum oleh keluarga korban apabila salah melakukan kompresi jantung "
        }
      ],
      "answer": "Penolong dalam keadaan letih atau bantuan medis telah datang atau korban kembali pulih",
      "score": 0,
      "status": ""
    },
    {
      "id": 17,
      "question": "Dimanakah letak jari pada saat kompresi jantung bayi?",
      "options": [
        {
          "a": "Di bawah garis intermammari",
          "b": "Di 1/3 tulang sternum",
          "c": "Di atas garis antar puting",
          "d": "Di dada bagian kiri"
        }
      ],
      "answer": "Di bawah garis intermammari",
      "score": 0,
      "status": ""
    },
    {
      "id": 18,
      "question": "Rantai bertahan hidup yang pertama untuk korban henti jantung pediatri di luar rumah sakit adalah",
      "options": [
        {
          "a": "Pencegahan",
          "b": "Panggil ambulance dan bawa AED",
          "c": "Cek respon korban",
          "d": "RJP kualitas tinggi"

        }
      ],
      "answer": "Pencegahan",
      "score": 0,
      "status": ""
    },
    {
      "id": 19,
      "question": "Besarnya energi pada saat defibrilasi syok pertama pada pediatri adalah",
      "options": [
        {
          "a": "4 J/kg",
          "b": "2 J/kg",
          "c": "360 J/kg",
          "d": "220 J/kg"
        }
      ],
      "answer": "2 J/kg",
      "score": 0,
      "status": ""
    },
    {
      "id": 20,
      "question": "Besarnya energi pada saat defibrilasi monofasik pada dewasa adalah",
      "options": [
        {
          "a": "4 J/kg",
          "b": "2 J/kg",
          "c": "360 J/kg",
          "d": "220 J/kg"
        }
      ],
      "answer": "360 J/kg",
      "score": 0,
      "status": ""
    }
  ]
}



var quizApp = function() {

  this.score = 0;
  this.qno = 1;
  this.currentque = 0;
  var totalque = quiz.JS.length;

  this.displayQuiz = function(cque) {
    this.currentque = cque;
    if (this.currentque < totalque) {
      $("#tque").html(totalque);
      $("#previous").attr("disabled", false);
      $("#next").attr("disabled", false);
      $("#qid").html(quiz.JS[this.currentque].id + '.');


      $("#question").html(quiz.JS[this.currentque].question);
      $("#question-options").html("");
      for (var key in quiz.JS[this.currentque].options[0]) {
        if (quiz.JS[this.currentque].options[0].hasOwnProperty(key)) {

          $("#question-options").append(
            "<div class='form-check option-block'>" +
            "<label class='form-check-label'>" +
            "<input type='radio' class='form-check-input' name='option'   id='q" + key + "' value='" + quiz.JS[this.currentque].options[0][key] + "'><span id='optionval' style='margin-left:30px'>" +
            quiz.JS[this.currentque].options[0][key] +
            "</span></label>"
          );
        }
      }
    }

    if (this.currentque <= 0) {
      $("#previous").attr("disabled", true);
    }

    if (this.currentque >= totalque) {
      $('#next').attr('disabled', true);
      if (confirm("kumpul?")) {
        for (var i = 0; i < totalque; i++) {
          this.score = this.score + quiz.JS[i].score;
        }
        stop();
        return this.showResult(this.score);
      } else {

      }
    }

    // if (this.currentque >= totalque) {
    //   $('#next').attr('disabled', true);
    //   for (var i = 0; i < totalque; i++) {
    //     this.score = this.score + quiz.JS[i].score;
    //   }
    //   return this.showResult(this.score);
    // }
  }

  this.showResult = function(scr) {
    $("#result").addClass('result');
    $("#result").html("<h1 class='res-header'>Nilai Anda: &nbsp;" + scr + '/100' + "</h1>");
    for (var j = 0; j < totalque; j++) {
      var res;
      if (quiz.JS[j].score == 0) {
        res = '<span class="wrong">' + quiz.JS[j].score + '</span><i class="fa fa-remove c-wrong"></i>';
      } else {
        res = '<span class="correct">' + quiz.JS[j].score + '</span><i class="fa fa-check c-correct"></i>';
      }
      $("#result").append(
        '<div class="result-question"><span>Q ' + quiz.JS[j].id + '</span> &nbsp;' + quiz.JS[j].question + '</div>' +
        '<div><b>Correct answer:</b> &nbsp;' + quiz.JS[j].answer + '</div>' +
        '<div class="last-row"><b>Score:</b> &nbsp;' + res +

        '</div>'

      );

    }
  }

  this.checkAnswer = function(option) {
    var answer = quiz.JS[this.currentque].answer;
    option = option.replace(/\</g, "&lt;")   //for <
    option = option.replace(/\>/g, "&gt;")   //for >
    option = option.replace(/"/g, "&quot;")

    if (option == quiz.JS[this.currentque].answer) {
      if (quiz.JS[this.currentque].score == "") {
        quiz.JS[this.currentque].score = 5;
        quiz.JS[this.currentque].status = "correct";
      }
    } else {
      quiz.JS[this.currentque].status = "wrong";
    }

  }

  this.changeQuestion = function(cque) {
    this.currentque = this.currentque + cque;
    this.displayQuiz(this.currentque);

  }

}


var jsq = new quizApp();

var selectedopt;
$(document).ready(function() {
  jsq.displayQuiz(0);

  $('#question-options').on('change', 'input[type=radio][name=option]', function(e) {

    //var radio = $(this).find('input:radio');
    $(this).prop("checked", true);
    selectedopt = $(this).val();
  });



});

let i = 1;


$('#next').click(function(e) {
  e.preventDefault();
  if (selectedopt) {
    jsq.checkAnswer(selectedopt);
  }
  jsq.changeQuestion(1);
  document.getElementById("no" + i++).style.background = "#DF2771";
});



$('#previous').click(function(e) {
  e.preventDefault();
  if (selectedopt) {
    jsq.checkAnswer(selectedopt);
  }
  jsq.changeQuestion(-1);
  document.getElementById("no" + --i).style.background = "white";
});



